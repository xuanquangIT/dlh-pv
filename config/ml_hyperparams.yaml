# ML Hyperparameters Configuration
# Defines model settings and training parameters

# Model selection
model:
  type: "gbt"  # Options: "decision_tree", "gbt" - GBT is production default
  
# Decision Tree Regressor parameters (alternative)
decision_tree:
  max_depth: 20
  min_instances_per_node: 20
  max_bins: 64
  min_info_gain: 0.0
  seed: 42

# Gradient Boosted Trees parameters (PRODUCTION - tuned for better RÂ²)
gbt:
  max_depth: 8  # Increased from 6 to reduce underfitting
  max_iter: 150  # Increased from 120 for better convergence
  step_size: 0.08  # Slightly lower for smoother learning
  min_instances_per_node: 20  # Reduced from 50 to allow finer splits
  max_bins: 256  # Increased from 128 for better numeric features
  subsample_rate: 0.85  # Increased from 0.8 for more data per tree
  feature_subset_strategy: "auto"
  min_info_gain: 0.005  # Reduced from 0.01 to allow more splits
  seed: 42

# Training parameters
training:
  sample_limit: 50000  # Balance between performance and memory
  train_ratio: 0.7
  validation_ratio: 0.15
  test_ratio: 0.15
  random_seed: 42
  min_rows_required: 500  # Increased from 50 to ensure statistically valid test set
  primary_metric: "rmse"  # Primary optimization metric

# Data split strategy
data_split:
  method: "temporal"  # Use temporal split for time series (avoid data leakage)
  seed: 42
  # For temporal split: train on older data, test on recent data

# Evaluation metrics to track
metrics:
  primary: "rmse"
  track:
    - "rmse"
    - "mae"
    - "r2"
    - "mse"

# MLflow experiment settings
mlflow:
  experiment_name: "pv_solar_regression"
  run_name_prefix: "regression_dt"
  artifact_path: "model"
  log_model: true
  log_artifacts: true

# Output table settings
output:
  gold_table: "lh.gold.fact_solar_forecast_regression"
  write_mode: "overwrite"
  enable_predictions_write: true
